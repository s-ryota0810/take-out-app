.shop#shop_show{ data: { shop_id: @shop.id } }
  .shop_detail
    .shop_detail_main
      - if user_signed_in? && current_user.admin?
        .shop_detail_main_edit
          %ul
            %li= link_to '編集', edit_shop_path(@shop)
            %li= link_to '削除', shop_path, data: { confirm: '削除しますか？', method: 'delete' }
      - elsif user_signed_in?
        .shop_detail_main_edit
          .favorite
            .with_favorited.hidden
              お気に入り解除
            .non_favorited.hidden
              お気に入り登録
      .shop_detail_name
        %h1= @shop.name
      .shop_detail_image
        = image_tag @shop.shop_image
      .shop_detail_review
        %p 星4つ
    .shop_detail_sub
      .shop_detail_sub_menu
        .shop_detail_sub_menu_el
          = link_to 'メニュー', '#'
        .shop_detail_sub_menu_el
          = link_to 'アクセス', '#'
        .shop_detail_sub_menu_el
          = link_to '口コミ', '#'
      .shop_detail_description
        .shop_detail_description_el
          %h2 メニュー一覧
          - @menus.each do |menu|
            .show_menu
              %dl.show_menu_info.clearfix
                %dt.menu_name= menu.name
                %dd.menu_price¥#{menu.price}
                - if user_signed_in? && current_user.admin?
                  .edit_menus
                    = link_to '編集', edit_shop_menu_path(@shop)
                    = link_to '削除', shop_menu_path(@shop, menu), data: { method: 'delete', confirm: 'メニュー情報を削除しますか'}
          - if user_signed_in? && current_user.admin?
            .new_menus
              = link_to 'メニューの追加', new_shop_menu_path(@shop)
        .shop_detail_description_el
          %h2 アクセス
          .show_access
            .show_access_map
              #map
              - google_api = "https://maps.googleapis.com/maps/api/js?key=#{ENV['GOOGLE_MAP_API']}&callback=initMap".html_safe
              %script{:async => "", :src=> google_api}
              = @shop.address
            .show_access_info
          
          :javascript
            let map;
            function initMap(){
              geocoder = new google.maps.Geocoder()
              
              map = new google.maps.Map(document.getElementById('map'), {
                center: {
                  lat: gon.shop.latitude,
                  lng: gon.shop.longitude
                },
                zoom: 15,
              });
              
              marker = new google.maps.Marker({
                position: {
                  lat: gon.shop.latitude,
                  lng: gon.shop.longitude
                },
                map: map
              });
            }
        .shop_detail_description_el
          %h2 クチコミ一覧
          .comments_container
          - if user_signed_in?
            .new_comment.modal_open
              %span クチコミの追加
            .modal_overlay.modal_close
            .modal_window
              = text_area_tag :comment_title, '', class: 'new_comment_form'
              = text_area_tag :comment_content, '', class: 'new_comment_form'
              #star
                = hidden_field_tag :comment_star, id: 'comment_star'
              :javascript
                $('#star').raty({
                  size     : 42,
                  starOff:  '#{asset_path("star-off.png")}',
                  starOn : '#{asset_path("star-on.png")}',
                  starHalf: '#{asset_path("star-half.png")}',
                  scoreName: 'comment[star]',
                  half: true,
                });
              %button.comment_btn_submit 投稿
              %button.comment_btn_cancel.modal_close キャンセル
= javascript_pack_tag 'shop'
